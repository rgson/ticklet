language: python

sudo: enabled

python:
  - 3.5
  - 3.6

script: make check

jobs:
  include:

    - stage: Debian
      install: >
        sudo apt-get install -yq --no-install-suggests --no-install-recommends
        devscripts fakeroot equivs &&
        mk-build-deps -i -s sudo -t 'apt-get -yq' debian/control
      before_script: |
        git clean -df
        git reset --hard
      script: >
        DEB_BUILD_OPTIONS=nocheck debuild -b -us -uc &&
        sudo apt install ../*.deb
        make installcheck prefix=/usr
      python: 3.5
      virtualenv:
        system_site_packages: true

notifications:
  email: false
